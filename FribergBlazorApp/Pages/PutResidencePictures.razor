@page "/erp/{id}"
@inject HttpClient client
@inject NavigationManager Navigation

<h3>Update Picture</h3>

<div>
    <label for="picture">Picture:</label>
    <input type="text" id="picture" @bind="picture.picture" />
</div>
<div>
    <label for="residenceId">Residence ID:</label>
    <input type="number" id="residenceId" @bind="picture.ResidenceId" />
</div>
<button @onclick="UpdatePicture">Update Picture</button>

<p>@returnText</p>

@code {
    Picture picture = new Picture();
    string returnText = "";

    [Parameter]
    public string? id { get; set; }

    protected override async Task OnInitializedAsync()
    {
        try
        {
            picture = await client.GetFromJsonAsync<Picture>($"api/residencepictures/{id}");
        }
        catch (Exception ex)
        {
            returnText = "Error1: " + ex.Message;
        }
    }

    async Task UpdatePicture()
    {
        try
        {
            HttpResponseMessage response = await client.PutAsJsonAsync($"api/residencepictures/{id}", picture);
            if (response.IsSuccessStatusCode)
            {
                returnText = "Picture updated successfully!";
                Navigation.NavigateTo("/rp");
            }
            else
            {
                returnText = "Failed to update Picture: " + response.ReasonPhrase;
            }
        }
        catch (Exception ex)
        {
            returnText = "Error2: " + ex.Message;
        }
    }
}
